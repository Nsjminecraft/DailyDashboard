<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Canada Info Page</title>
   <link rel="stylesheet" href="style.css">
   <style>
      .tradingview-widget-container {
         position: absolute;
         top: 75px;
         right: 0;
      }
      
   </style>
   <!-- Google Font Link for Icons -->
   <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
</head>
<body>
   <div class="container">
      <div class="current-weather-container" id="current-weather-container">
         <h2>Current Weather</h2>
         <p id="current-weather"></p>
      </div>
      <div class="holidays-container">
         <h2>Upcoming Canadian Holidays</h2>
         <ul id="holidays-list"></ul>
      </div>
      <div class="news-container ticker-container" id="news-ticker-container">
         <h1>Loading Canadian Breaking News...</h1>
      </div>
      <div class="clock-container">
         <div class="Clock" id="Clock"></div>
      </div>
      <div id="date-container">
         <h1 id="date"></h1>
     </div>
 
     <script>
         function formatDate(date) {
             const options = { year: 'numeric', month: 'long', day: 'numeric' };
             return date.toLocaleDateString(undefined, options);
         }
 
         const today = new Date();
         document.getElementById('date').textContent = formatDate(today);
     </script>
    <div class="card">
      <div class="search">
         <input type="text" placeholder="enter city name" spellcheck="false">
         <button><img src="images/search.png"></button>
      </div>
      <div class="weather">
         <img src="images/clear.png" class="weather-icon">  
         <h1 class="temp">23°c</h1>
         <h2 class="city">Toronto</h2>
         <div class="details">
            <div class="col">
               <img src="images/humidity.png">
               <div>
               </div>
               <p class="humidity">50%</p>
               <p>humidity</p>
            </div>
            <div class="col">
               <img src="images/wind.png">
               <div>
                  <p class="wind">15 km/h</p>
                  <p>Wind speed</p>
               </div>
            </div>
         </div>
      </div>
      <script>
         const apiKey = "97aa062504881d77be0dec64af78efae";
         const apiUrl = "https://api.openweathermap.org/data/2.5/weather?&units=metric&q=";
         
         const searchBox = document.querySelector(".search input");
         const searchBtn = document.querySelector(".search button");
         
         async function checkWeather(city){
          const response = await fetch(apiUrl + city +`&appid=${apiKey}`);
          var data = await response.json();
         
          console.log(data);
         
          document.querySelector(".city").innerHTML = data.name;
          document.querySelector(".temp").innerHTML = Math.round(data.main.temp) +"°c";
          document.querySelector(".humidity").innerHTML = data.main.humidity +"%";
          document.querySelector(".wind").innerHTML = data.wind.speed + "km/h";
         }
         
         searchBtn.addEventListener("click", ()=>{
          checkWeather(searchBox.value);
         })      
         
      </script>
         <div class="todo-container">
            <h2>To-Do List</h2>
            <div class="todo-input">
               <input type="text" id="new-task" placeholder="Add a new task">
               <button id="add-task-btn">Add</button>
            </div>
            <ul id="todo-list"></ul>
         </div>
         <script>
            document.getElementById('add-task-btn').addEventListener('click', function() {
               const taskText = document.getElementById('new-task').value;
               if (taskText) {
                  const li = document.createElement('li');
                  const deleteBtn = document.createElement('button');
                  const completeBtn = document.createElement('input');
                  const taskSpan = document.createElement('span');

                  taskSpan.textContent = taskText;
                  
                  completeBtn.type = 'radio';
                  completeBtn.className = 'complete-btn';
                  completeBtn.addEventListener('click', function() {
                     li.classList.toggle('completed');
                  });

                  deleteBtn.textContent = 'Delete';
                  deleteBtn.className = 'delete-btn';
                  deleteBtn.addEventListener('click', function() {
                     li.remove();
                  });

                  li.appendChild(completeBtn);
                  li.appendChild(taskSpan);
                  li.appendChild(deleteBtn);
                  document.getElementById('todo-list').appendChild(li);
                  document.getElementById('new-task').value = '';
               }
            });
         </script>
      </div>
      <!-- TradingView Widget BEGIN -->
      <div class="tradingview-widget-container" style="height:20%;width:30%;margin-right: 150px;top: 100px;">
         <div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div>
         <div class="tradingview-widget-copyright">
            <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
               <span class="blue-text">Track all markets on TradingView</span>
            </a>
         </div>
         <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
         {
            "autosize"; false,
            "symbol"; "NASDAQ:AAPL",
            "interval"; "D",
            "timezone"; "Etc/UTC",
            "theme"; "dark",
            "style"; "0",
            "locale"; "en",
            "allow_symbol_change"; true,
            "calendar"; false,
            "support_host"; "https://www.tradingview.com"
         
         }
         </script>
      </div>
      <!-- TradingView Widget END -->
      <div class="stock-widget">
         <div class="stock" id="AAPL">
             <div class="stock-info">
                 <div class="stock-symbol">AAPL</div>
                 <div class="stock-name">Apple Inc</div>
             </div>
             <div class="stock-change">
                 <div class="change">-2.52%</div>
             </div>
         </div>
         <div class="stock" id="TSLA">
             <div class="stock-info">
                 <div class="stock-symbol">TSLA</div>
                 <div class="stock-name">Tesla Inc</div>
             </div>
             <div class="stock-change">
                 <div class="change">-6.25%</div>
             </div>
         </div>
         <div class="stock" id="GOOGL">
             <div class="stock-info">
                 <div class="stock-symbol">GOOGL</div>
                 <div class="stock-name">Alphabet Inc</div>
             </div>
             <div class="stock-change">
                 <div class="change">-2.75%</div>
             </div>
         </div>
         <div class="stock" id="TD">
             <div class="stock-info">
                 <div class="stock-symbol">TD</div>
                 <div class="stock-name">Toronto-Dominion Bank</div>
             </div>
             <div class="stock-change">
                 <div class="change">+0.51%</div>
             </div>
         </div>
         <div class="stock" id="AMZN">
             <div class="stock-info">
                 <div class="stock-symbol">AMZN</div>
                 <div class="stock-name">Amazon.com Inc</div>
             </div>
             <div class="stock-change">
                 <div class="change">-2.74%</div>
             </div>
         </div>
         <div class="stock" id="MSFT">
             <div class="stock-info">
                 <div class="stock-symbol">MSFT</div>
                 <div class="stock-name">Microsoft Corp</div>
             </div>
             <div class="stock-change">
                 <div class="change">-2.71%</div>
             </div>
         </div>
     </div>
     <script>
         document.addEventListener('DOMContentLoaded', () => {
             const apiKey = '7KGX8SS8T5B4C2A8';
             const stocks = ['AAPL', 'TSLA', 'GOOGL', 'TD', 'AMZN', 'MSFT'];
     
             const fetchStockData = () => {
                 stocks.forEach(stock => {
                     fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${stock}&interval=1min&apikey=${apiKey}`)
                         .then(response => response.json())
                         .then(data => {
                             const timeSeries = data['Time Series (1min)'];
                             const lastRefreshed = data['Meta Data']['3. Last Refreshed'];
                             const lastPrice = parseFloat(timeSeries[lastRefreshed]['4. close']);
                             const previousPrice = parseFloat(Object.values(timeSeries)[1]['4. close']);
                             const change = ((lastPrice - previousPrice) / previousPrice * 100).toFixed(2);
                             const changeElement = document.querySelector(`#${stock} .change`);
                             changeElement.textContent = change > 0 ? `+${change}%` : `${change}%`;
                             changeElement.classList.toggle('up', change > 0);
                             changeElement.classList.toggle('down', change <= 0);
                         })
                         .catch(error => {
                             console.error('Error fetching data:', error);
                         });
                 });
             };
     
             fetchStockData(); // Initial fetch
             setInterval(fetchStockData, 60000); // Update every minute
         });
     </script>
      <div class="container">
         <p id="date"></p>
      </div>
      <div class="date-container">
         <p id="current-date"></p>
      </div>
   </div>
   <div class="wrapper">
      <header>
        <p class="current-date"></p>
        <div class="icons">
          <span id="prev" class="material-symbols-rounded">chevron_left</span>
          <span id="next" class="material-symbols-rounded">chevron_right</span>
        </div>
      </header>
      <div class="calendar">
        <ul class="weeks">
          <li>Sun</li>
          <li>Mon</li>
          <li>Tue</li>
          <li>Wed</li>
          <li>Thu</li>
          <li>Fri</li>
          <li>Sat</li>
        </ul>
        <ul class="days"></ul>
      </div>
   </div>
   <script src="script.js"></script>
</body>
</html>
